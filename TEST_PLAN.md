# Fairfield Airport Car Service – Test Plan

_Last updated: <!--DATE_AUTOGENERATED-->_

> Goal: Provide a checklist of **what to verify before each release**.  Tests are grouped by layer and tagged for Manual (🖐️) vs Automated (🤖) coverage.

---

## 1. Happy-Path Booking Flow (End-to-End)

| # | Scenario | Steps | Expected Result | Type |
|---|----------|-------|-----------------|------|
| 1 | New ride booking | Fill booking form → submit → redirected to Square checkout → pay deposit | Success page shows _Pending Confirmation_ status | 🖐️ / 🤖 |
| 2 | Webhook confirmation | After payment, Square webhook hits `/api/square-webhook` | Booking `status` flips to **confirmed** in Firestore; `/status/[id]` UI updates | 🤖 |

## 2. Address Autocomplete

| # | Scenario | Steps | Expected Result | Type |
|---|----------|-------|-----------------|------|
| 3 | Debounced suggestions | Type "500 Main St, Fairfield" slowly | Dropdown shows suggestions after ~300 ms; no excessive network calls | 🖐️ |
| 4 | Nationwide coverage | Enter "1600 Pennsylvania Avenue" | White House address appears | 🖐️ |

## 3. Fare Estimation

| # | Scenario | Steps | Expected Result | Type |
|---|----------|-------|-----------------|------|
| 5 | Base fare calc | Origin A → B (5 mi, 10 min) | Fare = `BASE_FARE + 5*3.5 + 10*0.5` rounded up | 🖐️ / Unit |
| 6 | Long-distance | 100 mi trip | No overflow; reasonable fare returned | Unit |

## 4. Scheduling & Overlap Logic

| # | Scenario | Steps | Expected Result | Type |
|---|----------|-------|-----------------|------|
| 7 | Overlap reject | Book ride 8-10 AM, then 9-11 AM | Second request auto-blocked | Unit / 🤖 |
| 8 | Buffer time | Book 8-9 AM, then 9-15 AM with 60 min buffer | Second request blocked | Unit |

## 5. Cancellation Policy

| # | Scenario | Steps | Expected Result | Type |
|---|----------|-------|-----------------|------|
| 9 | Cancel >24 h | Cancel ride 2 days before | Full refund; status `cancelled` | 🖐️ |
| 10 | Cancel 6 h before | 50 % fee retained | Refund amount correct | 🖐️ |
| 11 | No-show | Cancel <3 h | No refund | 🖐️ |

## 6. Communications

| # | Scenario | Steps | Expected Result | Type |
|---|----------|-------|-----------------|------|
|12| Confirmation SMS | Complete booking | Rider receives confirmation SMS with details | 🖐️ |
|13| Reminder SMS | 24 h before pickup (use time-travel in tests) | Reminder sent | 🤖 |
|14| Feedback SMS | Mark ride completed | Feedback link SMS sent | 🤖 |

## 7. Admin Dashboard

| # | Scenario | Steps | Expected Result | Type |
|---|----------|-------|-----------------|------|
|15| Login guard | Hit `/admin/bookings` while logged out | Redirect to `/admin/login` | 🖐️ / 🤖 |
|16| Booking list | After login | Table lists all bookings chronologically | 🖐️ |

## 8. UI & Responsiveness

- 📱 **Mobile (360 × 640)** – Booking form fields stack nicely; buttons finger-friendly
- 💻 **Desktop (1440 × 900)** – No unused whitespace
- 🌙 **Dark mode** – (when implemented) text remains readable

## 9. Performance & Security

| Check | Metric | Target |
|-------|--------|--------|
| Lighthouse mobile perf | Score | ≥ 80 |
| Vercel build | No ESLint errors, TypeScript passes | ✅ |
| Env vars | No secret leaked in client bundle except `NEXT_PUBLIC_` keys | ✅ |

## 10. Regression Suite (Post-MVP)

- Return-trip flow
- Loyalty / coupon code application
- Spanish i18n toggle
- Driver tracking map link

## 11. Automation Notes

- **Unit tests** – Jest → utilities (`fare`, scheduling overlap, webhook validator)
- **Integration** – Supertest against API routes (`estimate-fare`, `places-autocomplete`)
- **E2E** – Playwright: happy-path booking → payment stub → webhook simulation

---

### How to Use This Document
1. Mark each 🖐️ manual case as _✓ passed_ or _✗ failed_ during release QA.
2. Add new rows when features are added (and reference the section in your PR).
3. Tag tests with `🤖` only when they’re truly automated in CI; otherwise leave 🖐️.

_Let’s keep quality high as we ship fast!_ 